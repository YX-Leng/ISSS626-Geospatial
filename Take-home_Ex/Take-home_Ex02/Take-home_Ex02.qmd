---
title: "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics"
author: "Leng Yi Xiu"
date: "Oct 14 2024"
date-modified: "last-modified"
execute: 
  eval: true
  echo: true
  message: false
  freeze: true
---

## 1 Overview

Tourism is a major industry in Thailand, contributing around 20% to the country's gross domestic product (GDP). In 2019, Thailand generated 90 billion US dollars from both domestic and international tourism. However, due to the COVID-19 pandemic, this revenue sharply declined to 24 billion US dollars in 2020.

It's also important to recognize that Thailand's tourism economy is not evenly distributed across the country. The tourism economy of Thailand is mainly focused on five provinces, namely Bangkok, Phuket, Chiang Mai, Sukhothai and Phetchaburi.

### 1.1 Objective

The objective of this exercise is to explore whether key indicators of Thailand's tourism economy are independent of spatial and spatio-temporal factors. If dependencies exist, we want to identify clusters, outliers, and emerging hot or cold spots. The exercise involves the following tasks:

-   Create a geospatial data layer of Thailand's provinces (including Bangkok) as an *`sf`* polygon layer.

-   Develop a tourism economy indicators layer for the study area, also in *`sf`* polygon features.

-   Derive a tourism economy indicator layer in a spatio-temporal format (*`spacetime s3 class`*) using *`sfdep`*, maintaining a monthly and yearly time series.

-   Perform **global spatial autocorrelation analysis** using *`sfdep`* to determine overall spatial dependence.

-   Conduct **local spatial autocorrelation analysis** to detect specific clusters and outliers.

-   Carry out an **emerging hotspot analysis** to identify trends in hot or cold spots over time

-   Describe the spatial patterns revealed by the analysis above.

### 1.2 The Study Area

The focus of this exercise would be on the five provinces of Thiailand with highest tourism revenue, namely Bangkok, Phuket, Chiang Mai, Sukhothai and Phetchaburi.

## 2 Getting Started

The code chunk below installs and loads **sf**, **spdep**, **tmap**, **tidyverse, funModeling** packages into R environment

```{r}
pacman::p_load(sf, tmap, tidyverse, spdep, funModeling)
```

## 3 Data Preparation

For the purpose of this exercise, we will be using two data sets:

-   Thailand Domestic Tourism Statistics (**thaitour**)\
    The dataset contains statistics on domestic tourism in Thailand, by province, from Jan 2019 to Feb 2023. Information includes the number of tourists, the occupancy rate, the profits generated by tourism as well as the nationality of the tourists (Thai vs. foreign).

-   Thailand Subnational Adminstrative Boundaries (**province**)\
    The dataset contains Thailand's administrative level 0 (country), 1 (province), 2 (district), and 3 (sub-district, tambon) boundaries.

### 3.1 Importing data into R Environment

::: panel-tabset
## Tourism Statistics

```{r}
thaitour <- read_csv ("data/rawdata/thailand_domestic_tourism_2019_2023_ver2.csv")
```

```{r}
list(thaitour)
```

ðŸ’¡To check the different attributes in the data set

```{r}
thaitour %>%
  distinct(variable) %>%
  print()
```

## Administrative Boundaries

```{r}
province <- st_read(dsn = "data/rawdata", layer = "tha_admbnda_adm1_rtsd_20220121")
```

## 4 Exploratory Data Analysis (EDA)
:::
