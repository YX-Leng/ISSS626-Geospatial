---
title: "Take-home Exercise 3: Modelling Geography of Financial Inclusion with Geographically Weighted Methods"
author: "Leng Yi Xiu"
date: "Nov 2 2024"
date-modified: "last-modified"
execute: 
  eval: true
  echo: true
  message: false
  freeze: true
---

# 1 Overview

Tanzania is one of the Africaâ€™s fastest growing economies with nearly 7 percent annual national GDP growth since 2000. Despite the robust economic growth, widespread poverty persists. **Approximately 49% of Tanzaniaâ€™s population lives below the international extreme poverty line.** This could be due to the lack of financial inclusion - the availability and equality of opportunities to access financial services such as banking, loan, equity and insurance products.

## 1.1 Objective

The objective of this exercise is to build an exploratory model that determines factors affecting financial inclusion by using **non-spatial regression** and **geographically weighted regression methods**.

Examples of **independent** factors include demographics (rural vs urban), marital status, gender, financial education, access to technology etc.

Examples of **dependent** factors include savings, financial situation, free access to banks, insurance coverage etc.

------------------------------------------------------------------------

# 2 Getting Started

The code chunk below installs and loads **olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary** packages into R environment:

```{r}
pacman::p_load(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary)
```

------------------------------------------------------------------------

# 3 Data Preparation

For the purpose of this exercise, we will be using two data sets:

1.  District level boundary GIS data for Tanzania

2.  FinScope Tanzania 2023 Survey results

## 3.1 Importing data into R Environment

::: panel-tabset
## Geospatial

```{r}
GB = st_read(dsn = "data/rawdata/geospatial", layer = "geoBoundaries-TZA-ADM2")
```

ðŸ’¡ Updating CRS information

```{r}
st_crs(GB) <- 4210
GB <- st_transform(GB, crs = 32736)
head(GB, 5)
```

## Aspatial

```{r}
Tanz_raw = read_csv("data/rawdata/aspatial/FinScope Tanzania 2023_Individual Main Data_FINAL.csv")
```

```{r}
head(Tanz_raw, 5)
```

ðŸ’¡ Count number of unique dist_name

```{r}
Tanz_raw %>%
  count(dist_name) %>%
  print()
```
:::

## 3.2 Geospatial: Converting Multipolygon to Polygon

As the district level boundary GIS data in multipolygon form will cause overlays or intersections, it is more intuitive to calculate the area of each polygon and group them together by the unique district name and then select the largest polygon by area.

ðŸ’¡ Calculate the area of each polygon

```{r}
sf_GB <- GB %>%
  st_cast("POLYGON") %>%
  mutate(area = st_area(.))
```

ðŸ’¡ Group and select the largest polygon by area

```{r}
GB_clean <- sf_GB %>%
  group_by(shapeName) %>%
  filter(area == max(area)) %>%
  ungroup() %>%
  select(-area) %>%
  select(shapeName)
```

## 3.3 Aspatial: Filtering columns for information required

As the FinScope Tanzania 2023 dataset contains 721 variables and not all variables will be used in our analysis, we will filter for the necessary independent and dependent variables based to analyse on:

\(a\) how cluster type, gender and access to technology affects financial situation,

\(b\) how cluster type, gender and access to technology affects savings, and

\(c\) how cluster type, gender and access to technology affects insurance coverage for the Tanzanians.

```{r}
Tanz_filter <- Tanz_raw %>%
  select(dist_name, clustertype, c9, c23__1,c23__2,c23__3,e_7_n_3,e_7_n_4,F4_4,ins2,Household_weight,population_wt)
```

## 3.4 Aspatial: Rename Columns

```{r}
Tanz_filter <- Tanz_filter %>%
  rename(
    Gender = c9, 
    Access_MobilePhone = c23__1,
    Access_Internet = c23__2,
    Access_Computer = c23__3,
    Savings_Emerg = e_7_n_3,
    Fin_Situation = e_7_n_4,
    Savings_Type = F4_4,
    Insurance = ins2
    )
```

```{r}
head(Tanz_filter,5)
```

## 3.5 Perform relational join

```{r}

```

------------------------------------------------------------------------

# 4 Exploratory Data Analysis (EDA)
